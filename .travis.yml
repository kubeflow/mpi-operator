services:
  - docker

script:
  - docker build -t mpioperator/mpi-operator .
  - docker build -t mpioperator/kubectl-delivery cmd/kubectl-delivery
  - docker build -t mpioperator/tensorflow-benchmarks examples/tensorflow-benchmarks

after_script:
  - docker images

before_deploy:
  - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin

deploy:
  provider: script
  script: docker push mpioperator/mpi-operator \
    && docker push mpioperator/kubectl-delivery \
    && docker push mpioperator/tensorflow-benchmarks
  on:
    branch: master
